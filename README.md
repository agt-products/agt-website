# AGT Website

## Description
AGT website built with the MERN stack (MongoDB, Express, React/Redux, and Node.js).

## Table of Contents
* [Initial Setup](#initial-setup)
* [Database](#database)
    * [Collections](#collections)
        * [Products](#products)
        * [Users](#users)
        * [Projects](#projects)
        * [Quote Requests](#quote-requests)
* [APIs](#apis)
    * [Routes](#api-routes)
        * [Product Routes](#product-routes)
        * [User Routes](#user-routes)
        * [Project Routes](#project-routes)
        * [Quote Request Routes](#quote-request-routes)
* [Client Application](#client-application)
    * [React](#react)
    * [Redux](#redux)
* [Images & Graphics](#images-and-graphics)
    * [Visual Guide Images](#visual-guide-images)

## Initial Setup
1. Open up VS Code on your computer by pressing the Window key and typing **_code_**.
2. The local AGT project folder should be listed in recent projects. If not, the folder is located at C:\xampp\htdocs\agt. You will possibly need to clone the repo again, but there are two important files in the /config folder that are not in the repo.
> There are a couple of important files that are too sensitive to be in this repo that you will find located in the /config folder. They have to do with accessing the MongoDB collections. Make sure those are there. There is a file with more sensitive documentation that pertains to this as well as other things that should not be visible publicly in the local Matthew-Documents folder on your computer.
3. Read this and all available documentation. It will probably take you a while to wrap your head around all of it, even if you're more advanced than me.

## Database
The databases are MongoDB and they are currently hosted on a free MongoDB Atlas account that you can find the login info for in the local Z:\ root (you'll know it when you see it). The account will need to become a paid one, but for development I have not bothered setting that up yet. If you have any issues finding/accessing the MongoDB products collection, it also exists in JSON form in this very repo (see product-collection.json). There is info on how to make large scale updates to this collection in the local Z:\ root file. 

### Collections

#### Products
The Products collection. Some of the fields in the products are different from one another (hence using a non-relational database) but there are several fields that are actually defined in the [Product schema](models/Product.js):

- **product_id**:\
  This is separate from the autogenerated _id tag that MongoDB uses as the primary index. It is for querying individual products by URL in the client application.\
  **Number**, *Required*

- **series**:\
  This is the product series number. In most cases, it is the full product number minus the last two digit section. It should be unique, but it is not enforced because series is not an index.\
  **String**, *Required*

- **name**:\
  Product name. Does not need to be unique.\
  **String**, *Required*

- **images**:\
  An array of filenames for the products relevant images. The first image should always be the Visual Guide image (infographic). Some products still need images.\
  **\[String\]**, *Required*

- **categories**:\
  An array of URL strings that pertain to each category that the product should appear under. This allows some very dynamic categorization. Take a look at the products collection and compare the URLs in the [urls.js](client/routes) to get a better understanding.\
  **\[String\]**, *Required*

- **description**:\
  A product description string. Only a couple of products use this. Most of them have the desc_list instead.\
  **String**, *Optional*

- **desc_list**:\
  An array of strings making up a product description list. Most products use this.\
  **\[String\]**, *Optional*

#### Users
The Users collection. The current one will probably only have one or two entries. This is defined in the [User schema](models/User.js) and many of the fields are obvious, so I won't bother defining those, but as for the rest:

- **cart**:\
  The items the user has in their quote cart.\
  **Array**, *Optional*

- **projects**:\
  An array of projectId strings that reference documents in the Projects collection that the user has access to.\
  **Array**, *Optional*
  > I also have a system in place for hashing user passwords using JWT that is, to my knowledge, secure. You may want to further vet this process and change it if necessary, but since there is no need to involve payment information on the website, it's probably fine.

#### Projects
The Projects collection contains all User projects. I put them in their own collection so that multiple users can share access. In addition to the fields listed below, there are some obvious ones I'm not listing. You can see them all in the [Project schema](models/Project.js).

- **authorizedUsers**:\
  Array of user IDs of all users that are allowed to access a project.\
  **\[String\]**, *Required*

- **boards**:\
  Sort of a project within a project. Allowing multiple *boards* in one project enables users to consider multiple solutions and compare them.\
  **Array**, *Required*

#### Quote Requests
The QuoteRequest collection contains all quote requests submitted by users. [Quote Request schema](models/QuoteRequest.js).

- **userId**:\
  The _id of the user that made the quote request. Can be used to get that user's data in the AGT employees only section of the application (which has yet to be built at the time of this writing).\
  **String**, *Required*

- **products**:\
  An array of products being requested which would include additional info such as quantities.\
  **Array**, *Required*

- **requestData**:\
  A Date object timestamp of when the request was first submitted.\
  **Date**, *Required*

## APIs
The way I built the APIs may be a bit overengineered, so sorry about that. Each API is basically divided between three files separated out into three directories:\
1. [Models](/models)
2. [Controllers](/controllers)
3. [Routes](/routes/api)

Those routes are imported into [server.js](/server.js) to be added to the Express app.

### Product Routes
[Product API routes](routes/api/productRoutes.js)

- **api/products/category/:category.:limit.:page**:\
  *GET*\
  **Parameters:**\
    - *category*:\
      The category is a URL string that can actually be up to three levels deep (e.g. /display-hooks-and-accessories/hooks/slatwall) and is concatenated into one category string in the React application in [ProductList.js](client/src/components/product-components/ProductList.js) before being passed to the API. The Product model defines *categories* as an array of strings, so a product can be given any number of categories with any arbitrary name and they will be returned by a relevant query.\
    
    - *limit*:\
      The number of products to be returned to the application from the database.

    - *page*:\
      The "page" number of given query results.

- **api/products/:id**:\
  *GET*\
  Gets an individual product by its product_id (not _id, for the sake of prettier URLs).

- **api/products/search/:searchQuery/:limit/:page**:\
  *GET*\
  Gets a collection of products that match a search query. I establish the searchable fields and their weights in a commented out line in [Product.js](models/Product.js) for if/when it needs to be changed. The returned products are sorted by their relevency score. I am not an expert on optimizing search queries, so this may need some attention.
  
### User Routes
[User API routes](routes/api/userRoutes.js)\
I have set up the User API to use JWT to hash user passwords in the database and check user tokens (saved to localstorage) every time a user performs an action that requires authentication. This area is not my strong suit, so please look over what I have done to make sure it is secure.

- **api/users/register**:\
  *POST*\
  Register a new user.

- **api/users/token**:\
  *GET*\
  Authenticates user token before performing actions on their account.

- **api/users/login**
  *POST*\

- **api/users/logout**
  *GET*\

- **api/users/cart**:\
  *GET*\
  

### Project Routes

### Quote Request Routes

## Client Application

### React

### Redux

## Images and Graphics

### Visual Guide Images